{
  "metadata": {
    "id": "altlinux-8",
    "name": "Альт Сервер 8 hardening",
    "source": "alexbergh/secaudit-core",
    "version": "2025.10"
  },
  "environments": {
    "test": {
      "goal": "Валидация ролей и политик",
      "notes": "Используется локальный mirrors.altlinux.org"
    },
    "prod": {
      "goal": "Эксплуатация в сети мониторинга",
      "notes": "Журналы отправляются в Wazuh, контроль целостности включён"
    }
  },
  "controls": [
    {
      "id": "ALT8-CTRL-001",
      "title": "Строгая конфигурация SSH",
      "severity": "high",
      "category": "access_control",
      "tags": ["ssh", "crypto"],
      "secaudit_reference": "linux.ssh.strict_ciphers",
      "check": "grep -E 'Ciphers|MACs' /etc/ssh/sshd_config",
      "remediation": "Ciphers aes256-ctr,aes192-ctr,aes128-ctr",
      "metrics": {
        "expected": "aes256-ctr",
        "evidence": "/etc/ssh/sshd_config"
      }
    },
    {
      "id": "ALT8-CTRL-002",
      "title": "Настроить firewall на deny by default",
      "severity": "medium",
      "category": "network",
      "tags": ["iptables", "firewall"],
      "secaudit_reference": "linux.firewall.default_deny",
      "check": "iptables -L INPUT",
      "remediation": "Разрешить только ssh и osquery",
      "metrics": {
        "expected": "policy DROP",
        "evidence": "iptables-save"
      }
    },
    {
      "id": "ALT8-CTRL-003",
      "title": "Контроль прав на /etc/shadow",
      "severity": "medium",
      "category": "file_permissions",
      "tags": ["permissions", "shadow"],
      "secaudit_reference": "linux.permissions.shadow",
      "check": "stat -c %a /etc/shadow",
      "remediation": "Установить права 000",
      "metrics": {
        "expected": "000",
        "evidence": "/etc/shadow"
      }
    },
    {
      "id": "ALT8-CTRL-004",
      "title": "Ротация журналов auditd",
      "severity": "medium",
      "category": "logging",
      "tags": ["audit", "logrotate"],
      "secaudit_reference": "linux.audit.rotate",
      "check": "grep max_log_file /etc/audit/auditd.conf",
      "remediation": "max_log_file = 20",
      "metrics": {
        "expected": "max_log_file = 20",
        "evidence": "/etc/audit/auditd.conf"
      }
    },
    {
      "id": "ALT8-CTRL-005",
      "title": "Проверка целостности через aide",
      "severity": "high",
      "category": "fim",
      "tags": ["aide", "fim"],
      "secaudit_reference": "linux.aide.schedule",
      "check": "systemctl is-enabled aidecheck.timer",
      "remediation": "systemctl enable --now aidecheck.timer",
      "metrics": {
        "expected": "enabled",
        "evidence": "systemctl is-enabled aidecheck.timer"
      }
    }
  ]
}
