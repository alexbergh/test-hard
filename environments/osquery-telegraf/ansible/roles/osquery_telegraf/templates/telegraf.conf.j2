[[inputs.tail]]
  files = ["/var/log/osquery/osqueryd.results.log"]
  from_beginning = false
  data_format = "json"
  json_time_key = "calendarTime"
  json_time_format = "Jan 2 2006 15:04:05"
  json_time_zone = "Local"
  tag_keys = ["name", "hostIdentifier"]

[[inputs.file]]
  files = ["/var/log/osquery/osqueryd.snapshots.log"]
  data_format = "json"

{% for output in telegraf_outputs %}
{% if output.type == 'http' %}
[[outputs.http]]
  url = "{{ output.url }}"
  data_format = "json"
  method = "POST"
  timeout = "5s"
{% if output.headers is defined %}
{% for header, value in output.headers.items() %}
  [[outputs.http.headers]]
    key = "{{ header }}"
    value = "{{ value }}"
{% endfor %}
{% endif %}
  insecure_skip_verify = {{ 'true' if output.get('insecure_skip_verify', False) else 'false' }}
{% elif output.type == 'influxdb_v2' %}
[[outputs.influxdb_v2]]
{% if output.urls is defined %}
  urls = [{% for url in output.urls %}"{{ url }}"{% if not loop.last %}, {% endif %}{% endfor %}]
{% endif %}
  token = "{{ output.token }}"
  organization = "{{ output.organization }}"
  bucket = "{{ output.bucket }}"
{% endif %}
{% endfor %}
